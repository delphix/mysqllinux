<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://delphix.github.io/mysqllinux/Pre-Requisites/Manual_Ingestion_Mode.html">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Manual Ingestion - Delphix MySQL Plugin</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../stylesheets/extra.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-35429885-3', 'auto');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../index.html">Delphix MySQL Plugin</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../index.html" class="nav-link">Overview</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Pre Requisites <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="General.html" class="dropdown-item">General</a>
</li>
                                    
<li>
    <a href="Replication_Mode.html" class="dropdown-item">Replication</a>
</li>
                                    
<li>
    <a href="Manual_Ingestion_Mode.html" class="dropdown-item active">Manual Ingestion</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../PluginInstallation.html" class="nav-link">Plugin Installation</a>
                            </li>
                            <li class="navitem">
                                <a href="../Discovery.html" class="nav-link">Discovery</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Linking <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Linking/Replication_Mode.html" class="dropdown-item">Replication</a>
</li>
                                    
<li>
    <a href="../Linking/Manual_Ingestion_Mode.html" class="dropdown-item">Manual Ingestion</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../Provisioning.html" class="nav-link">Provisioning</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Release Notes <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Release_Notes/MySQL_2.0.26.html" class="dropdown-item">MySQL Plugin 2.0.26</a>
</li>
                                    
<li>
    <a href="../Release_Notes/MySQL_1.0.0.html" class="dropdown-item">MySQL Plugin 1.0.0</a>
</li>
                                    
<li>
    <a href="../Release_Notes/MySQL_2.1.0.html" class="dropdown-item">MySQL Plugin 2.1.0</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">References <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../References/ExitCodes.html" class="dropdown-item">Plugin Exit Codes</a>
</li>
                                    
<li>
    <a href="../References/Troubleshooting.html" class="dropdown-item">Troubleshooting</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="Replication_Mode.html" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../PluginInstallation.html" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#manual-ingestion" class="nav-link">Manual Ingestion</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#done-whats-next" class="nav-link">Done, What's Next?</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="manual-ingestion">Manual Ingestion<a class="headerlink" href="#manual-ingestion" title="Permanent link">&para;</a></h1>
<p>Given below are the pre-requisites for MySQL virtualization when using Manual Ingestion mode.</p>
<h3 id="source-environment-requirements">Source Environment Requirements<a class="headerlink" href="#source-environment-requirements" title="Permanent link">&para;</a></h3>
<p>Source environment is where the source MySQL databases are running.</p>
<h4 id="source-db-user">Source DB User<a class="headerlink" href="#source-db-user" title="Permanent link">&para;</a></h4>
<p>In Manual Ingestion mode, Delphix does not interact with the source database. 
Delphix creates a staging database and the backups are ingested manually by a customer user. </p>
<p>However, Delphix needs to be able to manage this staging database for snapshots and other time travel operations. 
Hence, we require a user with the following permissions on the staging database.</p>
<p><em>SELECT, SHUTDOWN, SUPER, RELOAD ,SHOW VIEW, EVENT, TRIGGER</em></p>
<p>There are 2 ways to achieve this</p>
<ol>
<li>Create this user on your source database so that when the backup is restored, this user is present in the staging db.</li>
<li>
<p>Create this user manually in the staging db. 
   In this case, the customer user must ensure that this user is always present in the staging db 
   and has the necessary privileges</p>
<p><div class="highlight"><pre><span></span><code>  mysql&gt;CREATE USER &#39;delphix_os&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;delphix_user_passwd&#39;;
</code></pre></div>
3. Grant the necessary privileges to the user.    </p>
<div class="highlight"><pre><span></span><code>mysql&gt; GRANT SELECT, SHUTDOWN, SUPER, RELOAD ,SHOW VIEW, EVENT, TRIGGER on *.* to &#39;delphix_os&#39;@&#39;localhost&#39;;
</code></pre></div>
</li>
</ol>
<p>You can also grant more permissive privileges</p>
<div class="highlight"><pre><span></span><code>  mysql&gt;GRANT ALL PRIVILEGES ON *.* TO &#39;user&#39;@&#39;%&#39;;
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note<p>Remember, this is the user that Delphix uses to manage the Staging database. 
So, if you're using Option#1 above, it is recommended that you create a dedicated source db user for Delphix with the privileges 
mentioned above.</p>
</p>
</div>
<h3 id="staging-environment-requirements">Staging Environment Requirements<a class="headerlink" href="#staging-environment-requirements" title="Permanent link">&para;</a></h3>
<h4 id="staging-os-user">Staging OS User<a class="headerlink" href="#staging-os-user" title="Permanent link">&para;</a></h4>
<p>This is a typical Delphix OS staging user.
Key requirements for this user are given below.</p>
<p>Please refer to Delphix Docs for more detailed requirements.</p>
<ul>
<li>
<p>A Delphix OS user with the elevated permissions to run <em>ps, mount, umount, mkdir, rmdir</em>
  commands without requiring a password</p>
<p><div class="code_box_outer">
    <div class="code_box_title">
          <span class="code_title"><em>/etc/sudoers</em></span>
    </div>
    <div>
        <div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nl">Defaults:</span><span class="n">delphix_os</span><span class="w"> </span><span class="o">!</span><span class="n">requiretty</span>
<span class="w">    </span><span class="n">delphix_os</span><span class="w"> </span><span class="n">ALL</span><span class="o">=</span><span class="nl">NOPASSWD:</span><span class="w"> </span><span class="err">\</span><span class="w"> </span>
<span class="w">    </span><span class="s">/bin/</span><span class="n">mount</span><span class="o">,</span><span class="w"> </span><span class="s">/bin/</span><span class="n">umount</span><span class="o">,</span><span class="w"> </span><span class="s">/bin/</span><span class="n">mkdir</span><span class="o">,</span><span class="w"> </span><span class="s">/bin/</span><span class="n">rmdir</span><span class="o">,</span><span class="w"> </span><span class="s">/bin/</span><span class="n">ps</span>
</code></pre></div>
    </div>
</div></p>
</li>
<li>
<p>Delphix OS user should be in the same primary and secondary groups as mysql user ( or the MySQL binary owner )</p>
</li>
<li>Delphix OS user must have execute access on all files within MySQL installation folder - Min permission level 775 recommended.</li>
</ul>
<h4 id="storage">Storage<a class="headerlink" href="#storage" title="Permanent link">&para;</a></h4>
<ul>
<li>Empty folder on staging host to hold delphix toolkit [ approximate 2GB free space ]</li>
</ul>
<h4 id="mysql-version-configuration">MySQL Version &amp; Configuration<a class="headerlink" href="#mysql-version-configuration" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>MySQL Binary version must match the version on the source database(s)</p>
</li>
<li>
<p>Starter <em>my.cnf</em> file <span class="code_title">[Recommended] </span></p>
<p>As every  organization's MySQL configuration is different,
Delphix expects a starter <em>my.cnf</em> file to be present in Delphix Toolkit Directory when creating a staging database.</p>
<p>Delphix will use this <em>my.cnf</em> file and modify it as per the configuration provided during the the dsource creation process.</p>
<p>This is recommended to reduce the possibility of errors while restoring the backup from the source database.</p>
<p>if tnis file is not provided, Delphix will create a <em>my.cnf</em> file from scratch. </p>
</li>
</ul>
<h3 id="target-environment-requirements">Target Environment Requirements<a class="headerlink" href="#target-environment-requirements" title="Permanent link">&para;</a></h3>
<h4 id="target-os-user">Target OS User<a class="headerlink" href="#target-os-user" title="Permanent link">&para;</a></h4>
<p>This is a typical Delphix OS target user.
Key requirements for this user are given below.</p>
<p>Please refer to Delphix Docs for more detailed requirements.</p>
<ul>
<li>
<p>A Delphix OS user with the elevated permissions to run <em>ps, mount, umount, mkdir, rmdir</em>
  commands without requiring a password</p>
<p><div class="code_box_outer">
    <div class="code_box_title">
          <span class="code_title"><em>/etc/sudoers</em></span>
    </div>
    <div>
        <div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nl">Defaults:</span><span class="n">delphix_os</span><span class="w"> </span><span class="o">!</span><span class="n">requiretty</span>
<span class="w">    </span><span class="n">delphix_os</span><span class="w"> </span><span class="n">ALL</span><span class="o">=</span><span class="nl">NOPASSWD:</span><span class="w"> </span><span class="err">\</span><span class="w"> </span>
<span class="w">    </span><span class="s">/bin/</span><span class="n">mount</span><span class="o">,</span><span class="w"> </span><span class="s">/bin/</span><span class="n">umount</span><span class="o">,</span><span class="w"> </span><span class="s">/bin/</span><span class="n">mkdir</span><span class="o">,</span><span class="w"> </span><span class="s">/bin/</span><span class="n">rmdir</span><span class="o">,</span><span class="w"> </span><span class="s">/bin/</span><span class="n">ps</span>
</code></pre></div>
    </div>
</div></p>
</li>
<li>
<p>Delphix OS user should be in the same primary and secondary groups as mysql user ( or the MySQL binary owner )</p>
</li>
<li>Delphix OS user must have execute access on all files within MySQL installation folder - Min permission level 775 recommended.</li>
</ul>
<h2 id="done-whats-next">Done, What's Next?<a class="headerlink" href="#done-whats-next" title="Permanent link">&para;</a></h2>
<p>Alright, we've taken care of all the pre-requisites. Next step - Install the plugin.   </p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2021 Delphix Corp.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
